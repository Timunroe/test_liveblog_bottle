% rebase('base.html', title='post_edit')

% if data['post'] is not None:
%   post_id, headline, content = data['post']['post_id'], data['post']['headline'], data['post']['content']
%   status, author = data['post']['status'], data['post']['author']
<h1 class="is-size-3 has-text-grey-lighter">Edit post</h1>
% else:
%    post_id, headline, content, status, author = 'new', '', '', '', ''
    <h1 class="is-size-3 has-text-grey-lighter">New post</h1>
% end
<form id="myForm" action="/save/{{data['page_id']}}/{{post_id}}" method="post">
    <div class="field">
        <label class="label">Subhead (optional)</label>
        <div class="control">
            <input class="input" name="subhead" type="text" value="{{headline}}" tabindex="1">
        </div>
        <p><small>Original content: {{headline}}</small></p>
     </div>
    <!-- Create the editor container -->
    <div class="field">
        <label class="label">Content</label>
        <div class="control">
            <textarea name="content" id="editor" rows="4" cols="50">
                {{!content}}
            </textarea>
        </div>
    </div>      

    <div class="field is-grouped">
        <div style="margin-right: 12px;">
            <label class="label">Status</label>
            <div class="control">
                <div class="select">
                    <select name="status">
                    % for item in ['draft', 'live']:
                        % if item == status:
                            <option value="{{item}}" selected>{{item}}</option>
                        % else:
                            <option value="{{item}}" >{{item}}</option>
                        % end
                    % end
                    </select>
                </div>
            </div>
        </div>
        <div>
            <label class="label">Author</label>
            <div class="control">
                <div class="select">
                    <select name="author">
                        % for author in authors:
                            % if author['name'] == author:
                                <option value="{{author['name']}}" selected>{{author['name']}}</option>
                            % else:
                                <option value="{{author['name']}}" >{{author['name']}}</option>
                            % end
                        % end
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="field is-grouped">
        <div style="margin-right: 12px;">
            <div class="control">
                <button class="button is-link" form="myForm" value="save">Save</button>
            </div>
        </div>
        <div>
            <div class="control">
                <input type="button" onclick="location.href='/page/{{data['page_id']}}';" class="button is-link" form="myForm" value="Cancel">
            </div>
        </div>
    </div>
</form>

% end
<script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/4.8.5/tinymce.min.js"></script>
<script>
    tinymce.init({
        selector: '#editor',
        height : 150,
        statusbar: false,
        menubar: false,
        plugins: [
            'advlist autolink lists link image charmap print preview anchor textcolor',
            'searchreplace visualblocks code fullscreen',
            'insertdatetime media table contextmenu paste code help wordcount'
        ],
        toolbar: 'insert | undo redo |  formatselect | bold italic backcolor  | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help',
        content_style: ".mce-content-body {font-size:14px;font-family:Verdana,Arial,Helvetica,sans-serif;}",
        content_css: [
            '//fonts.googleapis.com/css?family=Lato:300,300i,400,400i']
        });
</script>
